!function(e){e.fn.CircularCarousel=function(t){function i(e,t,i){var n=0,o=0,r=-i*(Math.PI/180),l=Math.sin(r),v=Math.cos(r),d=u,x=u+1;for(m=[],h.eq(u).addClass("active");o<g;){var M=(n+=360/g)*(Math.PI/180),C=Math.sin(M),z=Math.cos(M),A=e+(f*z*v-c*C*l),T=t+(f*z*l+c*C*v);A=Math.floor(A),T=Math.floor(T),++d<0?d=g-1:d===g&&(d=0),++x<0?x=g-1:x>=g&&(x=0),h.eq(d).css("margin-top",A+"px"),h.eq(d).css("margin-left",T+"px");var y={top:h.eq(x).offset().top,index:x};m.push(y),o++}var I=h.eq(u),B=h.eq(p);a.trigger("itemBeforeActive",I),a.trigger("itemBeforeDeactivate",B);setTimeout(function(){a.trigger("itemActive",I),a.trigger("itemAfterDeactivate",B)},q);s(u)}function n(e,t,n){var s=0;if(1===t)for(;s<e;){setTimeout(function(){h.eq(u).removeClass("active"),p=u,u++,o(),i(l,v,d,null)},s*n);s++}else{s=e;for(var r=0;s>0;){setTimeout(function(){h.eq(u).removeClass("active"),p=u,u--,o(),i(l,v,d,null)},r*n);r++,s--}}}function o(){u<0?u=g-1:u>=g&&(u=0)}function s(e){for(var t=m.sort(function(e,t){return e.top-t.top}),i=0;i<t.length;)t[i].index===e&&(h.eq(t[i].index-1).css({"z-index":t.length-1}),h.eq(t[i].index).css({"z-index":t.length-1})),h.eq(t[i].index).css("z-index",i),i++;var n=u+1;n<0?n=g-1:n>=g&&(n=0),h.eq(n).css("z-index",g),h.eq(u).css("z-index",g+1)}function r(e,t,i){for(var n=0,o=0,s=t;s!==i;)o++,s=s===e.length-1?0:s+1;for(s=t;s!==i;)n++,s=0===s?e.length-1:s-1;return n>o?{direction:1,steps:o}:{direction:0,steps:n}}var a=e(this),c=t.ovalWidth,f=t.ovalHeight,u=t.activeItem,l=t.offsetX,v=t.offsetY,d=t.angle,h=a.find("."+t.className),g=h.length,m=[],q=t.duration,p=u;i(l,v,d);setTimeout(function(){h.addClass("transition");var e=t.duration/1e3+"s";h.css("transition-duration",e)},10);return{cycleActive:function(e){h.eq(u).removeClass("active"),p=u,u="previous"===e?u-1:u+1,o(),i(l,v,d,null)},cycleActiveTo:function(e){if(h.eq(u).removeClass("active"),Math.abs(e-u)>=2){var t=r(h,u,e);n(t.steps,t.direction,q-100)}else p=u,u=e,o(),i(l,v,d,null)},on:function(e,t){a.on(e,t)}}}}(jQuery);
